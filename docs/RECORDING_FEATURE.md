# 录音功能使用说明

## 功能概述

Polyglot Singer 现在支持用户录制自己的发音，帮助用户练习和对比发音。

## 功能特性

### 1. 单词录音
- **触发方式**: 长按任意单词（500ms）
- **功能**: 
  - 如果没有录制过：录制自己的发音
  - 如果已经录制过：播放已录制的发音
  - 删除录音：删除已录制的发音

### 2. 整句录音
- **触发方式**: 长按歌词标题或行号（500ms）
- **功能**: 
  - 如果没有录制过：录制整句发音
  - 如果已经录制过：播放已录制的整句发音
  - 删除录音：删除已录制的整句发音

## 使用方法

### 录制单词发音
1. 在歌词分析页面，找到想要练习的单词
2. 长按单词（按住鼠标左键500毫秒）
3. 弹出录音菜单
4. 点击"录制发音"按钮
5. 允许浏览器访问麦克风
6. 说出单词的发音
7. 点击"停止录音"按钮完成录制

### 录制整句发音
1. 在歌词分析页面，找到想要练习的句子
2. 长按行号或歌词标题（按住鼠标左键500毫秒）
3. 弹出录音菜单
4. 点击"录制发音"按钮
5. 允许浏览器访问麦克风
6. 说出整句的发音
7. 点击"停止录音"按钮完成录制

### 播放录音
1. 长按已录制的单词或句子
2. 在弹出的菜单中选择"播放录音"
3. 系统会播放您之前录制的发音

### 删除录音
1. 长按已录制的单词或句子
2. 在弹出的菜单中选择"删除录音"
3. 确认删除操作

## 技术实现

### 数据库结构
- 新增 `recordings` 表存储录音数据
- 支持单词录音和整句录音
- 录音数据以Base64格式存储

### API接口
- `POST /api/recordings` - 保存录音
- `GET /api/recordings` - 获取录音
- `DELETE /api/recordings` - 删除录音

### 前端组件
- `RecordingMenu.svelte` - 录音菜单组件
- 集成到 `WordUnit.svelte` 和 `LyricDisplay.svelte`

## 注意事项

1. **浏览器权限**: 首次使用录音功能时需要允许浏览器访问麦克风
2. **网络连接**: 录音数据需要上传到服务器，请确保网络连接稳定
3. **存储限制**: 录音文件会占用存储空间，建议定期清理不需要的录音
4. **隐私保护**: 录音数据仅对用户本人可见，不会分享给其他用户

## 故障排除

### 无法录音
- 检查浏览器是否允许麦克风访问权限
- 确认麦克风设备正常工作
- 检查网络连接是否稳定

### 录音无法播放
- 刷新页面后重试
- 检查浏览器是否支持音频播放
- 确认录音文件是否完整上传

### 录音菜单不显示
- 确保长按时间足够（500毫秒）
- 检查是否有其他弹窗遮挡
- 刷新页面后重试 